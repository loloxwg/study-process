# :date:9.21å­¦ä¹ è®°å½•

# :tomato:TODO

- [x] GOè¯­è¨€æ ¸å¿ƒç¼–ç¨‹
- [ ] GOè¯­è¨€è¿›é˜¶è®¾è®¡
- [ ] ç½‘ç»œ
- [ ] ç³»ç»Ÿ
- [ ] MySQL
- [ ] Redis
- [ ] æŠ•é€’ç®€å†

# :o:GOæ ¸å¿ƒç¼–ç¨‹

## :package: å‡½æ•°ä½¿ç”¨ç»†èŠ‚

- goè¯­è¨€ä¸­ï¼Œå‡½æ•°ä¹Ÿæ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œå¯ä»¥èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡

![image-20210921122209995](https://gitee.com/loloxwg/picture/raw/master/202109211222086.png)



- å‡½æ•°å¯ä»¥ä½œä¸ºå½¢å‚ï¼Œå¹¶ä¸”è°ƒç”¨

  ![image-20210921122321924](https://gitee.com/loloxwg/picture/raw/master/202109211223970.png)

- goæ”¯æŒå¯å˜å‚æ•°

  ![image-20210921122427611](https://gitee.com/loloxwg/picture/raw/master/202109211224664.png)

  ![image-20210921122454755](https://gitee.com/loloxwg/picture/raw/master/202109211224813.png)

- ä¾‹å­

  ![image-20210921124131925](https://gitee.com/loloxwg/picture/raw/master/202109211241018.png)

## :package: initå‡½æ•°

### init() åœ¨main()ä¹‹å‰æ‰§è¡Œ

`main.go`

```go
package main
import (
	"fmt"
	//å¼•å…¥åŒ…
	"go_code/chapter06/funcinit/utils"
)

var age = test()

//ä¸ºäº†çœ‹åˆ°å…¨å±€å˜é‡æ˜¯å…ˆè¢«åˆå§‹åŒ–çš„ï¼Œæˆ‘ä»¬è¿™é‡Œå…ˆå†™å‡½æ•°
func test() int {
	fmt.Println("test()") //1
	return 90
}

//initå‡½æ•°,é€šå¸¸å¯ä»¥åœ¨initå‡½æ•°ä¸­å®Œæˆåˆå§‹åŒ–å·¥ä½œ
func init() {
	fmt.Println("init()...") //2
}

func main() {
	fmt.Println("main()...age=", age) //3
	fmt.Println("Age=", utils.Age, "Name=", utils.Name)

}
```
 `utils.go`
```go
package utils
import "fmt"
var Age int
var Name string

//Age å’Œ Name å…¨å±€å˜é‡ï¼Œæˆ‘ä»¬éœ€è¦åœ¨main.go ä½¿ç”¨
//ä½†æ˜¯æˆ‘ä»¬éœ€è¦åˆå§‹åŒ–Age å’Œ Name

//init å‡½æ•°å®Œæˆåˆå§‹åŒ–å·¥ä½œ
func init() {
	fmt.Println("utils åŒ…çš„  init()...")
	Age = 100
	Name = "tom~"
}
```

![image-20210921131040052](https://gitee.com/loloxwg/picture/raw/master/202109211310130.png)

### initå‡½æ•°æ³¨æ„äº‹é¡¹

![image-20210921131252550](https://gitee.com/loloxwg/picture/raw/master/202109211312617.png)

å¯¼åŒ…â€”â€”â€”->å…¨å±€å˜é‡â€”â€“>init()â€”â€”â€”â€”->main()



##:package: åŒ¿åå‡½æ•°

- åœ¨å®šä¹‰åŒ¿åå‡½æ•°æ—¶å°±ç›´æ¥è°ƒç”¨ï¼Œè¿™ç§æ–¹å¼åŒ¿åå‡½æ•°åªèƒ½è°ƒç”¨ä¸€æ¬¡
- å‡½æ•°å˜é‡åŒ¿åå‡½æ•°
- å…¨å±€åŒ¿åå‡½æ•°

```go
package main
import (
   "fmt"
)

var (
   //fun1å°±æ˜¯ä¸€ä¸ªå…¨å±€åŒ¿åå‡½æ•°
   Fun1 = func (n1 int, n2 int) int {
      return n1 * n2
   }
)

func main() {
   //åœ¨å®šä¹‰åŒ¿åå‡½æ•°æ—¶å°±ç›´æ¥è°ƒç”¨ï¼Œè¿™ç§æ–¹å¼åŒ¿åå‡½æ•°åªèƒ½è°ƒç”¨ä¸€æ¬¡

   //æ¡ˆä¾‹æ¼”ç¤º,æ±‚ä¸¤ä¸ªæ•°çš„å’Œï¼Œ ä½¿ç”¨åŒ¿åå‡½æ•°çš„æ–¹å¼å®Œæˆ
   res1 := func (n1 int, n2 int) int {
      return n1 + n2
   }(10, 20)

   fmt.Println("res1=", res1)

   //å°†åŒ¿åå‡½æ•°func (n1 int, n2 int) intèµ‹ç»™ aå˜é‡
   //åˆ™a çš„æ•°æ®ç±»å‹å°±æ˜¯å‡½æ•°ç±»å‹ ï¼Œæ­¤æ—¶,æˆ‘ä»¬å¯ä»¥é€šè¿‡aå®Œæˆè°ƒç”¨
   a := func (n1 int, n2 int) int {
      return n1 - n2
   }

   res2 := a(10, 30)
   fmt.Println("res2=", res2)
   res3 := a(90, 30)
   fmt.Println("res3=", res3)

   //å…¨å±€åŒ¿åå‡½æ•°çš„ä½¿ç”¨
   res4 := Fun1(4, 9)
   fmt.Println("res4=", res4)
}
```

## :package: é—­åŒ…

ä¸€ä¸ªå‡½æ•°ä¸æƒ³å¼•ç”¨çš„ç¯å¢ƒï¼ˆå˜é‡ï¼‰ç»„æˆçš„æ•´ä½“

é—­åŒ…å’ŒåŒ¿åå‡½æ•°å¯†ä¸å¯åˆ†

åŒ¿åå‡½æ•°å’Œå¼•ç”¨çš„å¤–éƒ¨å˜é‡æ„æˆä¸€ä¸ªé—­åŒ…

###:point_right: é—­åŒ…çš„ä¼˜åŠ¿

æ¯”æ™®é€šå‡½æ•°ä¼ å‚å°‘

é—­åŒ…å¯ä»¥ä¿ç•™ä¸Šæ¬¡å¼•ç”¨çš„å€¼ï¼Œä¼ å…¥ä¸€æ¬¡ï¼Œåå¤ä½¿ç”¨

æ¯”ç”¨å…¨å±€å˜é‡å¥½ç”¨

```go
package main
import (
   "fmt"
   "strings"
)


//ç´¯åŠ å™¨
func AddUpper() func (int) int {
   var n int = 10 
   var str = "hello"
   return func (x int) int {
      n = n + x
      str += string(36) // => 36 = '$'   
      fmt.Println("str=", str) // 1. str="hello$" 2. str="hello$$" 3. str="hello$$$"
      return n
   }
}

//
// 1)ç¼–å†™ä¸€ä¸ªå‡½æ•° makeSuffix(suffix string)  å¯ä»¥æ¥æ”¶ä¸€ä¸ªæ–‡ä»¶åç¼€å(æ¯”å¦‚.jpg)ï¼Œå¹¶è¿”å›ä¸€ä¸ªé—­åŒ…
// 2)è°ƒç”¨é—­åŒ…ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶åï¼Œå¦‚æœè¯¥æ–‡ä»¶åæ²¡æœ‰æŒ‡å®šçš„åç¼€(æ¯”å¦‚.jpg) ,åˆ™è¿”å› æ–‡ä»¶å.jpg , å¦‚æœå·²ç»æœ‰.jpgåç¼€ï¼Œåˆ™è¿”å›åŸæ–‡ä»¶åã€‚
// 3)è¦æ±‚ä½¿ç”¨é—­åŒ…çš„æ–¹å¼å®Œæˆ
// 4)strings.HasSuffix , è¯¥å‡½æ•°å¯ä»¥åˆ¤æ–­æŸä¸ªå­—ç¬¦ä¸²æ˜¯å¦æœ‰æŒ‡å®šçš„åç¼€ã€‚

func makeSuffix(suffix string) func (string) string {

   return func (name string) string {
      //å¦‚æœ name æ²¡æœ‰æŒ‡å®šåç¼€ï¼Œåˆ™åŠ ä¸Šï¼Œå¦åˆ™å°±è¿”å›åŸæ¥çš„åå­—
      if !strings.HasSuffix(name, suffix)  {
         return name + suffix
      }

      return name
   }
}


func makeSuffix2(suffix string, name string)  string {


   //å¦‚æœ name æ²¡æœ‰æŒ‡å®šåç¼€ï¼Œåˆ™åŠ ä¸Šï¼Œå¦åˆ™å°±è¿”å›åŸæ¥çš„åå­—
   if !strings.HasSuffix(name, suffix)  {
      return name + suffix
   }

   return name
   
}

func main() {
   
   //ä½¿ç”¨å‰é¢çš„ä»£ç 
   f := AddUpper()
   fmt.Println(f(1))// 11 
   fmt.Println(f(2))// 13
   fmt.Println(f(3))// 16


   //æµ‹è¯•makeSuffix çš„ä½¿ç”¨
   //è¿”å›ä¸€ä¸ªé—­åŒ…
   f2 := makeSuffix(".jpg") //å¦‚æœä½¿ç”¨é—­åŒ…å®Œæˆï¼Œå¥½å¤„æ˜¯åªéœ€è¦ä¼ å…¥ä¸€æ¬¡åç¼€ã€‚
   fmt.Println("æ–‡ä»¶åå¤„ç†å=", f2("winter")) // winter.jgp
   fmt.Println("æ–‡ä»¶åå¤„ç†å=", f2("bird.jpg")) // bird.jpg

   fmt.Println("æ–‡ä»¶åå¤„ç†å=", makeSuffix2("jpg", "winter")) // winter.jgp
   fmt.Println("æ–‡ä»¶åå¤„ç†å=", makeSuffix2("jpg", "bird.jpg")) // bird.jpg



}
```

## :package: defer

åœ¨å‡½æ•°ä¸­ï¼Œç¨‹åºå‘˜åˆ›å»ºèµ„æºï¼ˆæ•°æ®åº“è¿æ¥ï¼Œæ–‡ä»¶å¥æŸ„ï¼Œé”ï¼‰ï¼Œåœ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼ŒåŠæ—¶é‡Šæ”¾èµ„æºï¼Œä½¿ç”¨çš„å»¶æ—¶æœºåˆ¶

```
å½“æ‰§è¡Œåˆ°deferæ—¶ï¼Œä¼šå°†deferåé¢çš„è¯­å¥å‹å…¥åˆ°ç‹¬ç«‹çš„æ ˆä¸­(deferæ ˆ)
å½“å‡½æ•°æ‰§è¡Œå®Œæ¯•ä»¥åï¼Œåœ¨ä»deferæ ˆï¼ŒæŒ‰ç…§å…ˆå…¥åå‡ºçš„æ–¹å¼å‡ºæ ˆ
```



```go
package main
import (
   "fmt"
)

func sum(n1 int, n2 int) int {
   
   //å½“æ‰§è¡Œåˆ°deferæ—¶ï¼Œæš‚æ—¶ä¸æ‰§è¡Œï¼Œä¼šå°†deferåé¢çš„è¯­å¥å‹å…¥åˆ°ç‹¬ç«‹çš„æ ˆ(deferæ ˆ)
   //å½“å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå†ä»deferæ ˆï¼ŒæŒ‰ç…§å…ˆå…¥åå‡ºçš„æ–¹å¼å‡ºæ ˆï¼Œæ‰§è¡Œ
   defer fmt.Println("ok1 n1=", n1) //defer 3. ok1 n1 = 10
   defer fmt.Println("ok2 n2=", n2) //defer 2. ok2 n2= 20
   //å¢åŠ ä¸€å¥è¯
   n1++ // n1 = 11
   n2++ // n2 = 21
   res := n1 + n2 // res = 32
   fmt.Println("ok3 res=", res) // 1. ok3 res= 32
   return res

}

func main() {
   res := sum(10, 20)
   fmt.Println("res=", res)  // 4. res= 32
}
   
```

### deferæ³¨æ„äº‹é¡¹

![image-20210921161600311](https://gitee.com/loloxwg/picture/raw/master/202109211616382.png)

![image-20210921161631813](https://gitee.com/loloxwg/picture/raw/master/202109211616846.png)

### :point_right: defer åº”ç”¨

![image-20210921162201119](https://gitee.com/loloxwg/picture/raw/master/202109211622178.png)

![image-20210921162348290](https://gitee.com/loloxwg/picture/raw/master/202109211623331.png)

## :package:å‡½æ•°å‚æ•°çš„ä¼ é€’æ–¹å¼

### ä¸¤ç§ä¼ é€’

- å€¼ä¼ é€’ int floatç³»åˆ—, bool ,æ•°ç»„ï¼Œç»“æ„ä½“struct
- å¼•ç”¨ä¼ é€’ æŒ‡é’ˆ ï¼Œslice ï¼Œmap ,chan , interface

![image-20210921163804336](https://gitee.com/loloxwg/picture/raw/master/202109211638385.png)

### :point_right: æ³¨æ„äº‹é¡¹

å€¼ç±»å‹é»˜è®¤å€¼ä¼ é€’

å¼•ç”¨ç±»å‹é»˜è®¤å¼•ç”¨ä¼ é€’

![image-20210921164021625](https://gitee.com/loloxwg/picture/raw/master/202109211640717.png)

## :package:map

### Mapçš„å£°æ˜

###åŸºæœ¬è¯­æ³•

![image-20210921172250794](https://gitee.com/loloxwg/picture/raw/master/202109211722837.png)



**keyçš„ç±»å‹**

![image-20210921172408321](https://gitee.com/loloxwg/picture/raw/master/202109211724366.png)

**valueçš„ç±»å‹**

![image-20210921172456740](https://gitee.com/loloxwg/picture/raw/master/202109211724772.png)

:point_right: **å£°æ˜ä¸¾ä¾‹**

![image-20210921172551630](https://gitee.com/loloxwg/picture/raw/master/202109211725673.png)

```go
package main

import "fmt"

func main() {
   //mapçš„å£°æ˜å’Œæ³¨æ„äº‹é¡¹
   var a map[string]string
   //åœ¨ä½¿ç”¨mapå‰ï¼Œéœ€è¦å…ˆmake , makeçš„ä½œç”¨å°±æ˜¯ç»™mapåˆ†é…æ•°æ®ç©ºé—´
   a = make(map[string]string, 10)
   a["no1"] = "å®‹æ±Ÿ" //ok?
   a["no2"] = "å´ç”¨" //ok?
   a["no1"] = "æ­¦æ¾" //ok?
   a["no3"] = "å´ç”¨" //ok?
   fmt.Println(a)
}
```

### :point_down:Make()çš„ä½¿ç”¨

![image-20210921185956709](https://gitee.com/loloxwg/picture/raw/master/202109211859788.png)

###:point_right: ä¸‰ç§å£°æ˜ä½¿ç”¨æ–¹æ³•

```go
package main

import "fmt"

func main() {
   //ç¬¬ä¸€ç§ä½¿ç”¨æ–¹å¼
   var a map[string]string
   //åœ¨ä½¿ç”¨mapå‰ï¼Œéœ€è¦å…ˆmake , makeçš„ä½œç”¨å°±æ˜¯ç»™mapåˆ†é…æ•°æ®ç©ºé—´
   a = make(map[string]string, 10)
   a["no1"] = "å®‹æ±Ÿ" //ok?
   a["no2"] = "å´ç”¨" //ok?
   a["no1"] = "æ­¦æ¾" //ok?
   a["no3"] = "å´ç”¨" //ok?
   fmt.Println(a)

   //ç¬¬äºŒç§æ–¹å¼  å£°æ˜ç›´æ¥èµ‹å€¼
   cities := make(map[string]string)

   cities["no1"] = "beijing"
   cities["no2"] = "tianjin"
   cities["no3"] = "shanghai"
   fmt.Println(cities)

   //ç¬¬ä¸‰ç§æ–¹å¼
   heroes := map[string]string{
      "hero1": "songjiang",
      "hero2": "songjiba",
   }
   heroes["hero4"] = "zxwan"
   fmt.Println("heroes", heroes)

}
```

### :point_right: keyï¼š string    valueï¼š  map

```go
//æ¡ˆä¾‹
/*
   è¯¾å ‚ç»ƒä¹ ï¼šæ¼”ç¤ºä¸€ä¸ªkey-value çš„valueæ˜¯mapçš„æ¡ˆä¾‹
   æ¯”å¦‚ï¼šæˆ‘ä»¬è¦å­˜æ”¾3ä¸ªå­¦ç”Ÿä¿¡æ¯, æ¯ä¸ªå­¦ç”Ÿæœ‰ nameå’Œsex ä¿¡æ¯
   æ€è·¯:   map[string]map[string]string

*/

studentMap:=make(map[string]map[string]string)

studentMap["stu01"]=make(map[string]string,3)
studentMap["stu01"]["name"] ="tom"
studentMap["stu01"]["sex"] ="male"
studentMap["stu01"]["address"] ="beijing"

studentMap["stu02"]=make(map[string]string,3)
studentMap["stu02"]["name"] ="marry"
studentMap["stu02"]["sex"] ="male"
studentMap["stu02"]["address"] ="shanghai"

studentMap["stu03"]=make(map[string]string,3)
studentMap["stu03"]["name"] ="zom"
studentMap["stu03"]["sex"] ="male"
studentMap["stu03"]["address"] ="shenzhen"

fmt.Println(studentMap)
fmt.Println(studentMap["stu03"])
fmt.Println(studentMap["stu01"]["name"])
```

### mapçš„å¢åˆ æ”¹æŸ¥  delete()  make()

:paintbrush:åˆ é™¤ 

- `make(map[string]string)` **ä¸€æ¬¡æ€§åˆ é™¤**

  ![image-20210921201927424](https://gitee.com/loloxwg/picture/raw/master/202109212019464.png)

- **å•ä¸ªåˆ é™¤**  delete()

  ![image-20210921201857639](https://gitee.com/loloxwg/picture/raw/master/202109212018725.png)

:paintbrush:æŸ¥æ‰¾  `value,ok:=map[key]`

```go
package main

import "fmt"

func main() {

   cities := make(map[string]string)

   cities["no1"] = "beijing"
   cities["no2"] = "tianjin"
   cities["no3"] = "shanghai"

   fmt.Println("last:", cities)

   cities["no1"] = "shanxi"
   //å› ä¸ºè¿™ä¸ªno1å­˜åœ¨ åæ·»åŠ ç›´æ¥ä¿®æ”¹
   fmt.Println("now:", cities)

   //å› ä¸º no3è¿™ä¸ªkeyå·²ç»å­˜åœ¨ï¼Œå› æ­¤ä¸‹é¢çš„è¿™å¥è¯å°±æ˜¯ä¿®æ”¹
   cities["no3"] = "ä¸Šæµ·~"
   fmt.Println(cities)

   //æ¼”ç¤ºåˆ é™¤
   delete(cities, "no1")
   fmt.Println(cities)
   //å½“deleteæŒ‡å®šçš„keyä¸å­˜åœ¨æ—¶ï¼Œåˆ é™¤ä¸ä¼šæ“ä½œï¼Œä¹Ÿä¸ä¼šæŠ¥é”™
   delete(cities, "no4")
   fmt.Println(cities)

   //å¦‚æœå¸Œæœ›ä¸€æ¬¡æ€§åˆ é™¤æ‰€æœ‰çš„key
   //1. éå†æ‰€æœ‰çš„key,å¦‚ä½•é€ä¸€åˆ é™¤ [éå†]
   //2. ç›´æ¥makeä¸€ä¸ªæ–°çš„ç©ºé—´
   cities = make(map[string]string)
   fmt.Println(cities)

   val, ok := cities["no1"]
   if ok {
      fmt.Println("æœ‰key no1", val)
   } else {
      fmt.Println("æ²¡æœ‰ key:no1 ğŸ›")
   }
}
```

### map çš„éå† ä½¿ç”¨ for range :ok_hand:    for i:=0 :no_bicycles:

ç®€å•çš„

```go
cities := make(map[string]string)

cities["no1"] = "beijing"
cities["no2"] = "tianjin"
cities["no3"] = "shanghai"

for key, value := range cities {
   fmt.Printf("key: %v   value:%v\n", key, value)
}
```

åŒå±‚

```go
//ä½¿ç”¨for-rangeéå†ä¸€ä¸ªç»“æ„æ¯”è¾ƒå¤æ‚çš„map
studentMap := make(map[string]map[string]string)

studentMap["stu01"] = make(map[string]string, 3)
studentMap["stu01"]["name"] = "tom"
studentMap["stu01"]["sex"] = "ç”·"
studentMap["stu01"]["address"] = "åŒ—äº¬é•¿å®‰è¡—~"

studentMap["stu02"] = make(map[string]string, 3) //è¿™å¥è¯ä¸èƒ½å°‘!!
studentMap["stu02"]["name"] = "mary"
studentMap["stu02"]["sex"] = "å¥³"
studentMap["stu02"]["address"] = "ä¸Šæµ·é»„æµ¦æ±Ÿ~"

for k1, v1 := range studentMap {
   fmt.Println(k1)
   for k2, v2 := range v1 {
      fmt.Println(k2, v2)
   }
}
```

### :point_down:**mapçš„é•¿åº¦ len()**

**map çš„é•¿åº¦å…¶å®å°±æ˜¯é“¾åœ°å€æ³•ä¸­çš„æ•°ç»„é•¿åº¦**  æ•°ç»„ä¸­ä¿å­˜äº†key é“¾è¡¨ä¸­ä¿å­˜çš„ value

![image-20210921202202781](https://gitee.com/loloxwg/picture/raw/master/202109212022846.png)

```go
fmt.Println("cities æœ‰", len(cities), " å¯¹ key-value")
```

